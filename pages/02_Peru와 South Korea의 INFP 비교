import streamlit as st
import pandas as pd
import plotly.express as px

# ì œëª©
st.title("ğŸŒ êµ­ê°€ë³„ INFP ë¹„ìœ¨ ë¹„êµ ëŒ€ì‹œë³´ë“œ ğŸ’¡")

# CSV ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv("countriesMBTI_16types.csv")

# ë“œë¡­ë‹¤ìš´ì—ì„œ ë‚˜ë¼ ì„ íƒ (2ê°œ)
countries = st.multiselect(
    "ğŸ“Œ ë¹„êµí•  ë‚˜ë¼ë¥¼ ì„ íƒí•˜ì„¸ìš” (2ê°œ)", 
    df["Country"].sort_values(),
    default=["Peru", "South Korea"]
)

# ì„ íƒí•œ ë‚˜ë¼ë§Œ í•„í„°ë§
if len(countries) == 2:
    subset = df[df["Country"].isin(countries)][["Country", "INFP"]]

    # Plotly ë§‰ëŒ€ ê·¸ë˜í”„
    fig = px.bar(
        subset,
        x="Country",
        y="INFP",
        text="INFP",
        color="Country",
        color_discrete_sequence=px.colors.qualitative.Set2,
        title=f"ğŸŒ {countries[0]} vs {countries[1]} INFP ë¹„ìœ¨ ë¹„êµ"
    )

    # ê·¸ë˜í”„ ê¾¸ë¯¸ê¸°
    fig.update_traces(texttemplate="%{text:.2%}", textposition="outside")
    fig.update_layout(
        xaxis_title="êµ­ê°€",
        yaxis_title="INFP ë¹„ìœ¨",
        title_x=0.5,
        bargap=0.4,
        plot_bgcolor="white"
    )

    st.plotly_chart(fig, use_container_width=True)

else:
    st.info("âš ï¸ ë‚˜ë¼ë¥¼ ì •í™•íˆ 2ê°œ ì„ íƒí•´ì£¼ì„¸ìš”!")
